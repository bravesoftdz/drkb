<html>
<head>
  <title>Использование ADO (статья)</title>
  <meta http-equiv="Content-Type" content="text/html; charset=windows-1251" />
  <link type="text/css" href="css/css.css" rel="stylesheet" />
  <link type="text/css" href="css/sh.css" rel="stylesheet" />
  <script language="javascript" src="js/shInit.js"></script>
  <script language="javascript" src="js/shCore.js"></script>
  <script language="javascript" src="js/shBrushDelphi.js"></script>
  <script language="javascript" src="js/shBrushSql.js"></script>
</head>
<body>
<div id="layout">
<div id="header">
  <div id="logo"><img id="logo" src="img/logo.png" /></div>
  <div id="navigation">
    <p id="navigation">
      <a class="navigation" onclick="prev();" href="#">Предыдущая</a><br />
      <a class="navigation" onclick="up();" href="#">Наверх</a><br />
      <a class="navigation" onclick="next();" href="#">Следующая</a>
    </p>
  </div>
</div>
<div id="content">
<div id="explorer">DRKB Explorer</div>
  <h1 id="title">Использование ADO (статья)</h1>
<div id="date">01.01.2010</div>
<!-- Actual content start -->

<p id="note">Примечание от Vit</p>
<p>Данная статья взята с какой-то книги которую я нашёл на интернете. Причём к сожалению нет указаний ни на название книги, ни на автора, кроме того сия книга была отсканирована не самым тщательным образом и включает в себя огромное количество опечаток и неправильно распознанных слов, особенно в названиях свойств, методов и констант, а так же безобразно отформатированный код. Я попытался исправить максимальное количество таких опечаток настолько насколько это возможно не имея оригинала, но думаю, что часть ошибок всё ещё осталась, кроме того полностью переформатировал все примеры кода. Тем ни менее статью помещаю в DRKB в связи с довольно подробный и очень понятным описанием ADO</p>

<p>Технология ADO завоевала популярность у разработчиков, благодаря универсальности &#8212; базовый' набор интерфейсов OLE DB имеется в каждой современной операционной системе Microsoft. Поэтому для обеспечения доступа приложения к данным достаточно лишь правильно указать провайдер соединения ADO и затем переносить программу на любой компьютер, где имеется требуемая база данных и, конечно, установленная ADO. </p>

<p>Технология Microsoft ActiveX Data Objects обеспечивает универсальный доступ к источникам данных из приложений БД. Такую возможность предоставляют функции набора интерфейсов, созданные на основе общей модели объектов СОМ и описанные в спецификации OLE DB. </p>

<p>Технология ADO и интерфейсы OLE DB обеспечивают для приложений единый способ доступа к источникам данных различных типов. Например, приложение, использующее ADO, может применять одинаково сложные операции и к данным, хранящимся на корпоративном сервере SQL, и к электронным таблицам, и локальным СУБД. Запрос SQL, направленный любому источнику данных через ADO, будет выполнен. </p>

<p>Возникает вопрос: каким образом источники данных смогут выполнить этот запрос? </p>
<p>За серверы БД беспокоиться не стоит, обработка запросов SQL &#8212; это их основная обязанность. Но как быть с файловыми последовательностями, электронными таблицами, файлами электронной почты и т. д.? Здесь на помощь приходят механизмы ADO и интерфейсы OLE DB. </p>

<p>OLE DB представляет собой набор специализированных объектов СОМ, инкапсулирующих стандартные функции обработки данных, и специализированные функции конкретных источников данных и интерфейсов, обеспечивающих передачу данных между объектами. </p>

<p>Согласно терминологии ADO, любой источник данных (база данных, электронная таблица, файл) называется хранилищем данных, с которым при помощи провайдера данных взаимодействует приложение. Минимальный набор компонентов приложения может включать объект соединения, объект набора данных, объект процессора запросов. </p>

<p id="note">Примечание&nbsp; </p>

<p>Объекты OLE DB создаются и функционируют так же, как и другие объекты СОМ. Каждому объекту соответствует идентификатор класса CLSID, хранящийся в системном реестре. Для создания объекта используется метод CoCreateinstance и соответствующая фабрика класса. Объекту соответствует набор интерфейсов, к методам которых можно обращаться после создания объекта. </p>

<p>В результате приложение обращается не прямо к источнику данных, а к объекту OLE DB, который "умеет" представить данные (например, из файла электронной почты) в виде таблицы БД или результата выполнения запроса SQL. </p>

<p>Технология ADO в целом включает в себя не только сами объекты OLE DB, но и механизмы, обеспечивающие взаимодействие объектов с данными и приложениями. На этом уровне важнейшую роль играют провайдеры ADO, координирующие работу приложений с хранилищами данных различных типов. </p>

<p>Такая архитектура позволяет сделать набор объектов и интерфейсов открытым и расширяемым. Набор объектов и соответствующий провайдер может быть создан для любого хранилища данных без внесения изменений в исходную структуру ADO. При этом существенно расширяется само понятие данных &#8212; ведь можно разработать набор объектов и интерфейсов и для нетрадиционных табличных данных. Например, это могут быть графические данные геоинформационных систем, древовидные структуры из системных реестров, данные CASE-инструментов и т. д. </p>

<p>Так как технология ADO основана на стандартных интерфейсах СОМ, которые являются системным механизмом Windows, это сокращает общий объем работающего программного кода и позволяет распространять приложения БД без вспомогательных программ и библиотек. </p>

<p id="note">Примечание&nbsp; </p>

<p>Нижеследующее описание спецификации OLE DB представлено в соответствии с официальной терминологией Microsoft для данной предметной области. </p>

<p>Спецификация OLE DB различает следующие типы объектов:</p>

<p>Перечислитель (Enumerator) выполняет поиск источников данных или других перечислителей. Используется для обеспечения функционирования провайдеров ADO. </p>

<p>Объект-источник данных (Data Source Object) представляет хранилище данных. </p>

<p>Сессия (Session) объединяет совокупность объектов, обращающихся к одному хранилищу данных. </p>

<p>Транзакция (Trasaction) инкапсулирует механизм выполнения транзакции. </p>

<p>Команда (Command) содержит текст команды и обеспечивает ее выполнение. Командой может быть запрос SQL, обращение к таблице БД и т. д. </p>

<p>Набор рядов (Rowset) представляет собой совокупность строк данных, являющихся результатом выполнения команды ADO. </p>

<p>Объект-ошибка (Error) содержит информацию об исключительной ситуации. </p>
<p>Рассмотрим функциональные возможности основных объектов и интерфейсов OLE DB. </p>


</div>
<!-- Actual content end -->
<hr />
<div id="footer">
<p>&copy; DRKB Library, 2010<br />Разработка и поддержка &mdash; <a href="http://www.drkb.ru/" target="_blank">Quadr0</a></p>
</div>
</div>
</body>
</html>
