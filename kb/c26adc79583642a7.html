<html>
<head>
  <title>Перетаскиваем колонки и строки в TStringGrid мышью</title>
  <meta http-equiv="Content-Type" content="text/html; charset=windows-1251" />
  <link type="text/css" href="css/css.css" rel="stylesheet" />
  <link type="text/css" href="css/sh.css" rel="stylesheet" />
  <script language="javascript" src="js/shInit.js"></script>
  <script language="javascript" src="js/shCore.js"></script>
  <script language="javascript" src="js/shBrushDelphi.js"></script>
  <script language="javascript" src="js/shBrushSql.js"></script>
</head>
<body>
<div id="layout">
<div id="header">
  <div id="logo"><img id="logo" src="img/logo.png" /></div>
  <div id="navigation">
    <p id="navigation">
      <a class="navigation" onclick="prev();" href="#">Предыдущая</a><br />
      <a class="navigation" onclick="up();" href="#">Наверх</a><br />
      <a class="navigation" onclick="next();" href="#">Следующая</a>
    </p>
  </div>
</div>
<div id="content">
<div id="explorer">DRKB Explorer</div>
  <h1 id="title">Перетаскиваем колонки и строки в TStringGrid мышью</h1>
<div id="date">01.01.2010</div>
<!-- Actual content start -->

<pre name="code" class="delphi">
{ 
  The user can move rows and columns of a StringGrid with the mouse. 
  Can it also be done by code? 
  In the help for TCustomGrid you can see the methods MoveColumn and MoveRow, 
  but they are hidden in TStringGrid. 
  We can make them accessible again by subclassing TStringGrid and 
  declaring these methods as public: 
} 
 
type 
  TStringGridHack = class(TStringGrid) 
  public 
    procedure MoveColumn(FromIndex, ToIndex: Longint); 
    procedure MoveRow(FromIndex, ToIndex: Longint); 
  end; 
 
{ 
  The implementation of these methods simply consists of invoking the 
  corresponding method of the ancestor: 
} 
 
procedure TStringGridHack.MoveColumn(FromIndex, ToIndex: Integer); 
begin 
  inherited; 
end; 
 
procedure TStringGridHack.MoveRow(FromIndex, ToIndex: Integer); 
begin 
  inherited; 
end; 
 
 
// Example, Beispiel: 
 
procedure TForm1.Button1Click(Sender: TObject); 
begin 
  TStringGridHack(StringGrid1).MoveColumn(1, 3); 
end;
 
</pre>
<p>Взято с сайта: <a href="http://www.swissdelphicenter.ch" target="_blank">http://www.swissdelphicenter.ch</a></p>
</div>
<!-- Actual content end -->
<hr />
<div id="footer">
<p>&copy; DRKB Library, 2010<br />Разработка и поддержка &mdash; <a href="http://www.drkb.ru/" target="_blank">Quadr0</a></p>
</div>
</div>
</body>
</html>
